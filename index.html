<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Koelkast Shop</title>
  <!-- Speels lettertype -->
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <!-- JsBarcode Library voor barcode genereren -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <style>
    body {
      font-family: 'Comic Neue', cursive, sans-serif;
      background: linear-gradient(to bottom right, #fceabb, #f8b500);
      color: #333;
      padding: 20px;
      margin: 0;
    }
    /* Algemene styling voor de rijen */
    .row {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0px 4px 15px rgba(0,0,0,0.15);
      margin-bottom: 20px;
    }
    h1, h2, h3 {
      color: #ff6b81;
      margin-top: 0;
    }
    /* Top container met drie kolommen naast elkaar */
    #topContainer {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    #topContainer .col {
      flex: 1;
      min-width: 300px;
    }
    /* Producten: horizontale rij */
    #products {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .product {
      margin: 10px;
      padding: 15px;
      border: 2px solid #f8b500;
      font-size: 18px;
      cursor: pointer;
      background-color: #fff;
      border-radius: 15px;
      transition: all 0.3s ease;
      width: 150px;
      height: 150px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .product:hover,
    .product.selected {
      background-color: #ffeaa7;
      transform: scale(1.05);
    }
    button {
      margin-top: 20px;
      padding: 15px;
      font-size: 18px;
      border-radius: 15px;
      border: none;
      background-color: #ff6b81;
      color: #fff;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      background-color: #ff4757;
      transform: scale(1.03);
    }
    button:active {
      background-color: #ff2e2e;
    }
    .delete-btn {
      background-color: #ff7979;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
    }
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background: #fff url('data:image/svg+xml;utf8,<svg fill="%23999" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>') no-repeat right 10px center;
      background-size: 16px;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 14px;
    }
    table, th, td {
      border: 1px solid #f8b500;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #ff6b81;
      color: #fff;
    }
    /* Modal styling */
    #modal, #barcodeModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 10px;
      z-index: 1001;
      max-height: 80%;
      overflow-y: auto;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    #modal button, #barcodeModal button {
      margin-bottom: 10px;
      width: auto;
    }
  </style>
</head>
<body>
  <!-- Notificatie -->
  <div id="notification"></div>

  <!-- Top container: Overzicht, Producten en Gebruikers Barcode Lijst naast elkaar -->
  <div id="topContainer">
    <!-- Overzicht & Voorraad -->
    <div id="overzichtContainer" class="col row">
      <h2>Overzicht & Voorraad</h2>
      <div id="Overzicht"></div>
    </div>
    <!-- Producten -->
    <div id="productContainer" class="col row">
      <h2>Producten</h2>
      <div id="products"></div>
    </div>
    <!-- Gebruikers Barcode Lijst -->
    <div id="userBarcodeContainer" class="col row">
      <h2>Gebruikers Barcode Lijst</h2>
      <div id="userBarcodeList"></div>
    </div>
  </div>

  <!-- Onder de top container: Nieuwe gebruiker & Acties -->
  <div id="userActionsContainer" class="row">
    <h2>Nieuwe gebruiker & Acties</h2>
    <input type="text" id="username" placeholder="Jouw naam" list="usernames" autofocus />
    <datalist id="usernames"></datalist>
    <div id="barcodeScannerContainer">
      <label for="barcodeInput">Scan Barcode:</label>
      <input type="text" id="barcodeInput" placeholder="Scan hier je barcode" autofocus />
    </div>
    <div id="buttonContainer">
      <button onclick="confirmPurchase()">Bevestig aankoop</button>
      <button onclick="removePurchase()" class="delete-btn">Verwijder aankoop</button>
      <button onclick="showPurchases()" style="background-color:#007bff;">Bekijk recente aankopen</button>
      <button onclick="showBarcodeList()" style="background-color:#28a745;">Bekijk barcode lijst</button>
      <button onclick="showAdminOverview()" style="background-color:#f44e90;">Admin Overzicht</button>
    </div>
  </div>

  <!-- Modals -->
  <div id="modal">
    <button onclick="closeModal()">Sluiten</button>
    <div id="modalContent"></div>
  </div>
  <div id="barcodeModal">
    <button onclick="closeBarcodeModal()">Sluiten</button>
    <div id="barcodeListModal"></div>
  </div>

  <!-- Admin Overzicht -->
  <div id="adminView" class="row" style="display: none;">
    <h1>Admin Overzicht</h1>
    <div id="adminContent"></div>
    <button onclick="removeAllInfo()" style="background-color:#ff7979;">Verwijder alle info</button>
    <button onclick="hideAdminOverview()" style="background-color:#6c757d;">Terug</button>
    <div class="admin-section">
      <h2>Gebruikers Barcode Lijst</h2>
      <div id="userBarcodeListAdmin"></div>
      <button onclick="exportUserBarcodes()">Exporteer User Barcodes</button>
      <label for="importFile" style="display:block;margin-top:10px;">Importeer User Barcodes:</label>
      <input type="file" id="importFile" onchange="importUserBarcodes(event)" />
    </div>
  </div>

  <script>
    /**********************
     * NOTIFICATIE FUNCTIE
     **********************/
    function showNotification(message, type = "success") {
      const notif = document.getElementById("notification");
      notif.innerText = message;
      notif.className = "";
      notif.classList.add("show", type);
      notif.style.display = "block";
      setTimeout(() => {
        notif.style.display = "none";
      }, 3000);
    }
    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }
    function closeBarcodeModal() {
      document.getElementById("barcodeModal").style.display = "none";
    }

    /**********************
     * ADMIN MENU FUNCTIES
     **********************/
    function showAdminOverview() {
      document.getElementById("adminView").style.display = "block";
      updateAdminContent();
    }
    function hideAdminOverview() {
      document.getElementById("adminView").style.display = "none";
    }
    function removeAllInfo() {
      if (confirm("Weet je zeker dat je alle informatie wilt verwijderen?")) {
        localStorage.clear();
        location.reload();
      }
    }

    /**********************
     * PRODUCT- & BARCODE SETUP
     **********************/
    // Hardcoded productcategorieën
    let productCategories = [
      { key: "snacks", label: "Snacks", defaultPrice: 0.50, barcode: "123456789012" },
      { key: "kinderBueno", label: "Kinder Bueno", defaultPrice: 0.75, barcode: "234567890123" },
      { key: "drinken", label: "Drinken", defaultPrice: 0.80, barcode: "345678901234" },
      { key: "overige", label: "Overige dranken", defaultPrice: 1.10, barcode: "456789012345" }
    ];
    localStorage.setItem("productCategories", JSON.stringify(productCategories));

    // Inventory en userBarcodes
    let inventory = JSON.parse(localStorage.getItem("inventory"));
    if (!inventory) {
      inventory = {
        snacks: ["Lion", "Twix", "Mars", "Snickers", "Kitkat"],
        drinken: ["Coca-Cola", "Coca-Cola Zero", "Coca-Cola Cherry", "Coca-Cola Vanille", "7UP"],
        kinderBueno: ["Kinder Bueno"],
        overige: ["Arizona", "Dr Pepper"]
      };
      localStorage.setItem("inventory", JSON.stringify(inventory));
    }
    let userBarcodes = JSON.parse(localStorage.getItem("userBarcodes"));
    if (!userBarcodes) {
      userBarcodes = {};
      localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
    }
    let currentUser = "";

    // Nieuwe gebruiker: maak barcode aan bij blur
    document.getElementById("username").addEventListener("blur", function() {
      let username = this.value.trim();
      if (username && !userBarcodes[username]) {
        let newUserBarcode = Math.floor(100000000000 + Math.random() * 900000000000).toString();
        userBarcodes[username] = newUserBarcode;
        localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
        updateUserBarcodeList();
        updateUserBarcodeListAdmin();
      }
      if (username) {
        currentUser = username;
      }
    });

    // Focus op barcodeInput wanneer niet op username/barcodeInput wordt geklikt
    document.addEventListener("click", function(e) {
      if (e.target.id === "username" || e.target.id === "barcodeInput") return;
      document.getElementById("barcodeInput").focus();
    });

    let selectedCounts = {};

    // Laad de producten en genereer duidelijke barcodes
    function loadProducts() {
      const container = document.getElementById("products");
      container.innerHTML = "";
      productCategories.forEach(category => {
        let div = document.createElement("div");
        div.className = "product";
        div.dataset.key = category.key;

        // Label
        let labelDiv = document.createElement("div");
        labelDiv.textContent = category.label;
        labelDiv.style.fontWeight = "bold";
        div.appendChild(labelDiv);

        // SVG voor productbarcode
        let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.id = "barcode-" + category.key;
        svg.style.display = "block";
        svg.style.margin = "10px auto";
        div.appendChild(svg);

        // Genereer een duidelijke barcode
        JsBarcode(svg, category.barcode, { 
          format: "CODE128", 
          displayValue: true, 
          width: 3, 
          height: 60, 
          margin: 5 
        });

        // Klik: selecteer product (teller ophogen)
        div.addEventListener("click", function() {
          let count = selectedCounts[category.key] || 0;
          count = count ? count + 1 : 1;
          selectedCounts[category.key] = count;
          labelDiv.textContent = category.label + (count > 1 ? " (" + count + ")" : "");
          div.classList.add("selected");
        });

        // Rechterklik: teller verlagen
        div.addEventListener("contextmenu", function(e) {
          e.preventDefault();
          let count = selectedCounts[category.key] || 0;
          if (count > 0) {
            count--;
            if (count === 0) {
              delete selectedCounts[category.key];
              labelDiv.textContent = category.label;
              div.classList.remove("selected");
            } else {
              selectedCounts[category.key] = count;
              labelDiv.textContent = category.label + " (" + count + ")";
            }
          }
        });

        container.appendChild(div);
      });
    }

    /**********************
     * AANKOOP & OVERZICHT FUNCTIES
     **********************/
    function confirmPurchase() {
      let username = document.getElementById("username").value.trim();
      if (!username) {
        showNotification("Vul je naam in!", "error");
        return;
      }
      if (!userBarcodes[username]) {
        let newUserBarcode = Math.floor(100000000000 + Math.random() * 900000000000).toString();
        userBarcodes[username] = newUserBarcode;
        localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
        updateUserBarcodeList();
        updateUserBarcodeListAdmin();
      }
      currentUser = username;
      if (Object.keys(selectedCounts).length === 0) {
        showNotification("Kies minstens één categorie!", "error");
        return;
      }
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      if (!purchases[username]) {
        purchases[username] = [];
      }
      for (let [catKey, count] of Object.entries(selectedCounts)) {
        let category = productCategories.find(c => c.key === catKey);
        for (let i = 0; i < count; i++) {
          let purchase = { 
            name: category.label, 
            price: category.defaultPrice,
            category: category.key,
            timestamp: new Date().toISOString() 
          };
          purchases[username].push(purchase);
        }
      }
      localStorage.setItem("purchases", JSON.stringify(purchases));
      updateDatalist();
      updateOverzicht();
      showNotification(`${username}, je hebt je aankoop bevestigd.`, "success");
      selectedCounts = {};
      document.querySelectorAll(".product").forEach(el => {
        let key = el.dataset.key;
        let cat = productCategories.find(c => c.key === key);
        if (cat) {
          let label = el.querySelector("div");
          if (label) label.textContent = cat.label;
        }
        el.classList.remove("selected");
      });
    }

    function removePurchase() {
      let username = document.getElementById("username").value.trim();
      if (!username) {
        showNotification("Vul je naam in om je aankopen te bekijken.", "error");
        return;
      }
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      if (!purchases[username] || purchases[username].length === 0) {
        showNotification("Je hebt nog geen aankopen om te verwijderen.", "error");
        return;
      }
      let categoryCounts = {};
      purchases[username].forEach(purchase => {
        categoryCounts[purchase.name] = (categoryCounts[purchase.name] || 0) + 1;
      });
      let message = "Welke aankoop wil je verwijderen? Voer het nummer in:\n";
      let categoryList = Object.keys(categoryCounts);
      categoryList.forEach((catName, index) => {
        message += `${index + 1}. ${catName} (${categoryCounts[catName]}x)\n`;
      });
      let input = prompt(message);
      let selectedIndex = parseInt(input) - 1;
      if (isNaN(selectedIndex) || selectedIndex < 0 || selectedIndex >= categoryList.length) {
        showNotification("Ongeldige invoer.", "error");
        return;
      }
      let selectedCategoryName = categoryList[selectedIndex];
      let idx = purchases[username].findIndex(p => p.name === selectedCategoryName);
      if (idx === -1) {
        showNotification("Categorie niet gevonden.", "error");
        return;
      }
      let removed = purchases[username].splice(idx, 1);
      localStorage.setItem("purchases", JSON.stringify(purchases));
      updateOverzicht();
      showNotification(`Er is 1x ${removed[0].name} verwijderd.`, "success");
    }

    function showPurchases() {
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      let allPurchases = [];
      for (let user in purchases) {
        purchases[user].forEach(p => {
          allPurchases.push({ ...p, user });
        });
      }
      allPurchases.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      let html = "<table><tr><th>Tijd</th><th>Gebruiker</th><th>Product</th><th>Prijs</th></tr>";
      allPurchases.forEach(p => {
        html += `<tr>
                    <td>${new Date(p.timestamp).toLocaleString()}</td>
                    <td>${p.user}</td>
                    <td>${p.name}</td>
                    <td>€${p.price.toFixed(2)}</td>
                 </tr>`;
      });
      html += "</table>";
      document.getElementById("modalContent").innerHTML = html;
      document.getElementById("modal").style.display = "block";
    }

    function updateDatalist() {
      let datalist = document.getElementById("usernames");
      datalist.innerHTML = "";
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      for (let user in purchases) {
        let option = document.createElement("option");
        option.value = user;
        datalist.appendChild(option);
      }
    }

    function updateOverzicht() {
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      let users = Object.keys(purchases).map(user => {
        let totalSpent = purchases[user].reduce((sum, p) => sum + p.price, 0);
        return { user, totalSpent };
      });
      users.sort((a, b) => b.totalSpent - a.totalSpent);
      
      let html = "<h3>Top 5 Personen</h3>";
      html += "<table>";
      html += "<tr><th>Gebruiker</th>";
      productCategories.forEach(product => {
        html += `<th>${product.label}</th>`;
      });
      html += "<th>Totaal (€)</th></tr>";
      
      users.slice(0, 5).forEach(({user, totalSpent}) => {
        html += `<tr><td>${user}</td>`;
        productCategories.forEach(product => {
          let count = purchases[user].filter(p => p.category === product.key).length;
          html += `<td>${count > 0 ? product.label + " x" + count : "-"}</td>`;
        });
        html += `<td>€${totalSpent.toFixed(2)}</td>`;
        html += "</tr>";
      });
      html += "</table>";
      
      let inv = JSON.parse(localStorage.getItem("inventory"));
      html += "<h3>Voorraad</h3>";
      html += "<table>";
      html += "<tr><th>Categorie</th><th>Items</th></tr>";
      productCategories.forEach(cat => {
        let items = (inv[cat.key] || []).join(", ");
        html += `<tr><td>${cat.label}</td><td>${items || "Geen items"}</td></tr>`;
      });
      html += "</table>";
      
      document.getElementById("Overzicht").innerHTML = html;
    }

    /**********************
     * ADMIN FUNCTIES
     **********************/
    function updateAdminContent() {
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      let users = Object.keys(purchases).map(user => {
        let totalSpent = purchases[user].reduce((sum, p) => sum + p.price, 0);
        return { user, totalSpent };
      });
      users.sort((a, b) => b.totalSpent - a.totalSpent);
      
      let html = "<table>";
      html += "<tr><th>Gebruiker</th>";
      productCategories.forEach(product => {
        html += `<th>${product.label}</th>`;
      });
      html += "<th>Totaal</th><th>Acties</th></tr>";
      
      users.forEach(({user, totalSpent}) => {
        html += `<tr><td>${user}</td>`;
        productCategories.forEach(product => {
          let count = purchases[user].filter(p => p.category === product.key).length;
          html += `<td>${count > 0 ? product.label + " x" + count : "-"}</td>`;
        });
        html += `<td>€${totalSpent.toFixed(2)}</td>
                 <td>
                   <button onclick="removeUser('${user}')">Verwijder gebruiker</button><br/>
                   <button onclick="adminRemoveProduct('${user}')">Verwijder 1 aankoop</button><br/>
                   <button onclick="adminRemoveAllGoods('${user}')">Verwijder alle aankopen</button>
                 </td>
                 </tr>`;
      });
      html += "</table>";
      document.getElementById("adminContent").innerHTML = html;
    }

    function removeUser(username) {
      if (confirm(`Weet je zeker dat je alle aankopen van ${username} wilt verwijderen?`)) {
        let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
        delete purchases[username];
        localStorage.setItem("purchases", JSON.stringify(purchases));
        updateDatalist();
        updateOverzicht();
        updateAdminContent();
        showNotification(`Alle aankopen van ${username} zijn verwijderd.`, "success");
      }
    }

    function adminRemoveProduct(username) {
      let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
      if (!purchases[username] || purchases[username].length === 0) {
        showNotification("Deze gebruiker heeft geen aankopen.", "error");
        return;
      }
      let categoryCounts = {};
      purchases[username].forEach(purchase => {
        categoryCounts[purchase.name] = (categoryCounts[purchase.name] || 0) + 1;
      });
      let message = `Welke aankoop wil je verwijderen voor ${username}? Voer het nummer in:\n`;
      let categoryList = Object.keys(categoryCounts);
      categoryList.forEach((catName, index) => {
        message += `${index + 1}. ${catName} (${categoryCounts[catName]}x)\n`;
      });
      let input = prompt(message);
      let selectedIndex = parseInt(input) - 1;
      if (isNaN(selectedIndex) || selectedIndex < 0 || selectedIndex >= categoryList.length) {
        showNotification("Ongeldige invoer.", "error");
        return;
      }
      let selectedCategoryName = categoryList[selectedIndex];
      let idx = purchases[username].findIndex(p => p.name === selectedCategoryName);
      if (idx === -1) {
        showNotification("Categorie niet gevonden.", "error");
        return;
      }
      let removed = purchases[username].splice(idx, 1);
      localStorage.setItem("purchases", JSON.stringify(purchases));
      updateOverzicht();
      updateAdminContent();
      showNotification(`Er is 1x ${removed[0].name} verwijderd voor ${username}.`, "success");
    }

    function adminRemoveAllGoods(username) {
      if (confirm(`Weet je zeker dat je alle aankopen van ${username} wilt verwijderen?`)) {
        let purchases = JSON.parse(localStorage.getItem("purchases")) || {};
        if (!purchases[username] || purchases[username].length === 0) {
          showNotification("Deze gebruiker heeft geen aankopen.", "error");
          return;
        }
        purchases[username] = [];
        localStorage.setItem("purchases", JSON.stringify(purchases));
        updateOverzicht();
        updateAdminContent();
        showNotification(`Alle aankopen van ${username} zijn verwijderd.`, "success");
      }
    }

    /**********************
     * USER BARCODE MANAGEMENT (MET WEERGAVE ALS BARCODE)
     **********************/
    function updateUserBarcodeList() {
      const container = document.getElementById("userBarcodeList");
      container.innerHTML = "";
      for (let username in userBarcodes) {
        const div = document.createElement("div");
        div.style.marginBottom = "15px";
        const nameEl = document.createElement("strong");
        nameEl.textContent = username + ": ";
        div.appendChild(nameEl);
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.style.display = "inline-block";
        svg.style.verticalAlign = "middle";
        svg.style.marginRight = "10px";
        JsBarcode(svg, userBarcodes[username], { 
          format: "CODE128", 
          displayValue: true, 
          width: 2, 
          height: 50, 
          margin: 5 
        });
        div.appendChild(svg);
        const btn = document.createElement("button");
        btn.textContent = "Verwijder";
        btn.style.marginLeft = "10px";
        btn.onclick = function() {
          delete userBarcodes[username];
          localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
          updateUserBarcodeList();
          updateUserBarcodeListAdmin();
          showNotification(`Barcode voor ${username} is verwijderd.`, "success");
        };
        div.appendChild(btn);
        container.appendChild(div);
      }
    }

    function updateUserBarcodeListAdmin() {
      const container = document.getElementById("userBarcodeListAdmin");
      container.innerHTML = "";
      for (let username in userBarcodes) {
        const div = document.createElement("div");
        div.style.marginBottom = "15px";
        const nameEl = document.createElement("strong");
        nameEl.textContent = username + ": ";
        div.appendChild(nameEl);
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.style.display = "inline-block";
        svg.style.verticalAlign = "middle";
        svg.style.marginRight = "10px";
        JsBarcode(svg, userBarcodes[username], { 
          format: "CODE128", 
          displayValue: true, 
          width: 2, 
          height: 50, 
          margin: 5 
        });
        div.appendChild(svg);
        const btn = document.createElement("button");
        btn.textContent = "Verwijder";
        btn.style.marginLeft = "10px";
        btn.onclick = function() {
          delete userBarcodes[username];
          localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
          updateUserBarcodeList();
          updateUserBarcodeListAdmin();
          showNotification(`Barcode voor ${username} is verwijderd.`, "success");
        };
        div.appendChild(btn);
        container.appendChild(div);
      }
    }

    function exportUserBarcodes() {
      const dataStr = JSON.stringify(userBarcodes, null, 2);
      const blob = new Blob([dataStr], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "userBarcodes.json";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    function importUserBarcodes(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const importedData = JSON.parse(e.target.result);
          Object.assign(userBarcodes, importedData);
          localStorage.setItem("userBarcodes", JSON.stringify(userBarcodes));
          updateUserBarcodeList();
          updateUserBarcodeListAdmin();
          showNotification("User barcodes succesvol geïmporteerd.", "success");
        } catch (err) {
          showNotification("Fout bij het importeren van de data.", "error");
        }
      };
      reader.readAsText(file);
    }

    /**********************
     * INITIAL LOAD
     **********************/
    loadProducts();
    updateOverzicht();
    updateDatalist();
    updateUserBarcodeList();
    updateUserBarcodeListAdmin();
  </script>
</body>
</html>
